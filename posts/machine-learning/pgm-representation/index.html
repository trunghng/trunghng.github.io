<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Probabilistic Graphical Model - Representation | Trung's Place</title><meta name=keywords content="machine-learning"><meta name=description content="Notes on Bayesian Networks and Markov Random Fields."><meta name=author content="Trung H. Nguyen"><link rel=canonical href=https://trunghng.github.io/posts/machine-learning/pgm-representation/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://trunghng.github.io/images/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://trunghng.github.io/images/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://trunghng.github.io/images/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://trunghng.github.io/images/favicon/apple-touch-icon.png><link rel=mask-icon href=https://trunghng.github.io/images/favicon/android-chrome-512x512.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=text/x-mathjax-config>
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
    "HTML-CSS": {availableFonts: []}
  });
</script><script type=text/x-mathjax-config>
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      "HTML-CSS": {availableFonts: []},
      TeX: {
        equationNumbers: { autoNumber: "AMS" },
      },
    });
  </script><script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><style>.post-content{text-align:justify;font-size:15px}.post-content h1,h2,h3,h4,h5,h6{text-align:left}.post-content a,.post-content a:link,.post-content a:visited,.post-content a:hover,.post-content a:active{box-shadow:none;font-weight:700;color:#4682b4}.post-content ol,.post-content ul{margin-left:10px}.post-content li>ol,.post-content li>ul{margin-left:30px}#roman-list,#number-list,#alpha-list{counter-reset:section}#roman-list>li{list-style:none;position:relative}#number-list>li{list-style:none;position:relative}#alpha-list>li{list-style:none;position:relative}#roman-list>li:before{counter-increment:section;content:"(" counter(section,lower-roman)") ";position:absolute;left:-2em}#number-list>li:before{counter-increment:section;content:"(" counter(section,decimal)") ";position:absolute;left:-2em}#alpha-list>li:before{counter-increment:section;content:"(" counter(section,lower-alpha)") ";position:absolute;left:-2em}figcaption{font-size:14px}.toc{font-size:15px}.post-footer{font-size:15px}.post-content figure>figcaption{all:revert;font-size:12px;width:70%;text-align:center;margin-left:15%}.post-content figure>figcaption>p{all:revert}.post-content h3{font-size:28px}.post-content h4{font-size:24px}.post-content h5{font-size:20px}.post-content h6{font-size:16px}</style><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Probabilistic Graphical Model - Representation"><meta property="og:description" content="Notes on Bayesian Networks and Markov Random Fields."><meta property="og:type" content="article"><meta property="og:url" content="https://trunghng.github.io/posts/machine-learning/pgm-representation/"><meta property="og:image" content="https://trunghng.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-12-10T17:55:57+07:00"><meta property="article:modified_time" content="2022-12-10T17:55:57+07:00"><meta property="og:site_name" content="Trung's Place"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://trunghng.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Probabilistic Graphical Model - Representation"><meta name=twitter:description content="Notes on Bayesian Networks and Markov Random Fields."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://trunghng.github.io/posts/"},{"@type":"ListItem","position":3,"name":"Probabilistic Graphical Model - Representation","item":"https://trunghng.github.io/posts/machine-learning/pgm-representation/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Probabilistic Graphical Model - Representation","name":"Probabilistic Graphical Model - Representation","description":"Notes on Bayesian Networks and Markov Random Fields.\n","keywords":["machine-learning"],"articleBody":"Notes on Bayesian Networks and Markov Random Fields.\nGraphs A graph, denoted $\\mathcal{K}$ is a tuple of $\\mathcal{X}$ and $\\mathcal{E})$ where $\\mathcal{X}=\\{X_1,\\ldots,X_n\\}$ is the sets of nodes (or vertices) and $\\mathcal{E}$ is the set of edges. \\begin{equation} \\mathcal{K}=(\\mathcal{X},\\mathcal{E}) \\end{equation}\nNodes, Edges Any pair of nodes $X_i,X_j$, for $i\\neq j$ is connected by either a directed edge $X_i\\rightarrow X_j$ or an undirected edge $X_i-X_j$1. We use the notation $X_i\\rightleftharpoons X_j$ to denote that $X_i$ is connected to $X_j$ via some edge, whether directed (in any direction) or undirected.\nIf the graph contains directed edges only, we call it a directed graph, denoted $\\mathcal{G}$, else if the graph established by undirected edge only, it is referred as undirected graph, denoted $\\mathcal{H}$.\nFigure 1: (taken from the PGM book) Example of a partially directed graph $\\mathcal{K}$ Following are some necessary notations:\nIf $X_i\\rightarrow X_j\\in\\mathcal{E}$, we say that $X_i$ is the parent of $X_j$ while $X_j$ is the child of $X_i$.\nE.g. node $I$ is a child of nodes $C,E$ and $H$ while $D$ is a parent of $G$. If $X_i-X_j\\in\\mathcal{E}$, we say that $X_i$ is a neighbor of $X_j$, and vice versa.\nE.g. node $F$ is a neighbor of $G$. If $X\\rightleftharpoons Y\\in\\mathcal{E}$, we say that $X$ and $Y$ are adjacent.\nE.g. nodes $A$ and $C$ are adjacent, while $D$ is adjacent to $E$. We use $\\text{Pa}_X$ to denote the set of parents of $X$, $\\text{Ch}_X$ to denote the set of its children and $\\text{Nb}_X$ to denote its neighbors. The set $\\text{Boundary}_X\\doteq\\text{Pa}_X\\cup\\text{Nb}_X$ is known as the boundary of $X$.\nE.g. $\\text{Pa}_I=\\{C,E,H\\}$ and $\\text{Boundary}_F=\\text{Pa}_F\\cup\\text{Nb}_F=\\{C\\}\\cup\\{G\\}=\\{C,G\\}$. The degree of a node $X$ is the number of edges in which it participates; its indegree is the number of directed edges $Y\\rightarrow X$. The degree of a graph is the maximal degree of a node in the graph.\nE.g. node $D$ has degree of $3$, indegree of $0$; the graph $\\mathcal{K}$ has degree of $3$. Subgraphs Consider the graph $\\mathcal{K}=(\\mathcal{X},\\mathcal{E})$ and let $\\mathbf{X}\\subset\\mathcal{X}$ be a subset of nodes in $\\mathcal{K}$. Then:\nThe induced subgraph of $\\mathcal{K}$, denoted $\\mathcal{K}[\\mathbf{X}]$ is defined as the graph $(\\mathbf{X},\\mathcal{E}')$ where \\begin{equation} \\mathcal{E}'=\\{X\\rightleftharpoons Y:X,Y\\in\\mathbf{X}\\} \\end{equation} A subgraph over $\\mathbf{X}$ is complete if every two nodes in $\\mathbf{X}$ are connected via some edges. The set $\\mathbf{X}$ is known as a clique; or even a maximal clique if for any set of nodes $\\mathbf{Y}\\supset\\mathbf{X}$, $\\mathbf{Y}$ is not a clique, i.e. \\begin{equation} \\{\\mathbf{Y}\\text{ clique}:\\mathbf{Y}\\supset\\mathbf{X}\\}=\\emptyset \\end{equation} The set $\\mathbf{X}$ is called upward closed in $\\mathbf{K}$ if for any $X\\in\\mathbf{X}$, we have that \\begin{equation} \\text{Boundary}_X\\subset\\mathbf{X} \\end{equation} The upward closure of $\\mathbf{X}$ is the minimal closed subset $\\mathbf{Y}$ covering $\\mathbf{X}$, i.e. \\begin{equation} \\mathbf{Y}=\\sup\\{\\bar{\\mathbf{Y}}\\text{ upward closed in }\\mathcal{K}:\\bar{\\mathbf{Y}}\\supset\\mathbf{X}\\} \\end{equation} The upwardly closed subgraph of $\\mathbf{X}$, denoted $\\mathcal{K}^+[\\mathbf{X}]$, is the induced subgraph over $\\mathbf{Y}$, $\\mathcal{K}[\\mathbf{Y}]$. Paths, Trails Consider the graph $\\mathcal{K}=(\\mathcal{X},\\mathcal{E})$, the basic notion of edges gives rise to following definitions:\n$X_1,\\ldots,X_k$ form a path in $\\mathcal{K}$ if for every $i=1,\\ldots,k-1$, we have that either $X_i\\rightarrow X_{i+1}$ or $X_i-X_{i+1}$. A path is directed if there exists a directed edge $X_i\\rightarrow X_{i+1}$. $X_1,\\ldots,X_k$ form a trail in $\\mathcal{K}$ if for every $i=1,\\ldots,k-1$, we have that $X_i\\rightleftharpoons X_{i+1}$. $\\mathcal{K}$ is connected if for every pair $X_i,X_j$ there is a trail between $X_i$ and $X_j$. $X$ is an ancestor of $Y$ and correspondingly $Y$ is a descendant of $X$ in $\\mathcal{K}$ if there exists a directed path $X_1,\\ldots,X_k$ with $X_1=X$ and $X_k=Y$. An ordering of nodes $X_1,\\ldots,X_n$ is a topological ordering relative to $\\mathbf{K}$ if whenever we have $X_i\\rightarrow X_j\\in\\mathcal{E}$, then $i\\lt j$. This gives rise to critical results that for each node $X_i$, we have that \\begin{equation} \\text{Pa}_{X_i}\\subset\\{X_1,\\ldots,X_{i-1}\\}, \\end{equation} and \\begin{equation} \\text{Ch}_{X_i}\\subset\\{X_{i+1},\\ldots,X_n\\} \\end{equation} Cycles, Loops A cycle in $\\mathcal{K}$ is a directed path $X_1,\\ldots,X_k$ where $X_1=X_k$. $\\mathcal{K}$ is acyclic if it contains no cycles. $\\mathcal{K}$ is a directed acyclic graph (or DAG) if it is both directed and acyclic. An acyclic graph containing both directed and undirected edges is known as a partially directed acyclic graph (or PDAG).\nLet $\\mathcal{K}$ be a PDAG over $\\mathcal{X}$ and let $\\mathbf{K}_1,\\ldots,\\mathbf{K}_\\ell$ be a disjoint partition of $\\mathcal{X}$ such that: the induced subgraph over $\\mathbf{K}_i$ contains no directed edges; for any pair of nodes $X\\in\\mathbf{K}_i$ and $Y\\in\\mathbf{K}_j$ for $i\\lt j$, an edge between $X$ and $Y$ can only be a directed edge $X\\rightarrow Y$. Each component $\\mathbf{K}_i$ is called a chain component, while $\\mathcal{K}$ is referred as a chain graph. A loop in $\\mathcal{K}$ is a trail $X_1,\\ldots,X_k$ where $X_1=X_k$. A graph is singly connected if it contains no loops. A node in a singly connected graph is called a leaf if it has exactly one adjacent node. A singly connected directed graph is called a polytree, while a singly connected undirected graph is known as a forest; if it is also connected, it is called a tree. A directed graph is a forest if each node has at most one parent. A directed forest is a tree if it is also connected. Directed Graphical Model A Directed Graphical Model (or Bayesian network) is a tuple $\\mathcal{B}=(\\mathcal{G},P)$ where\n$\\mathcal{G}$ is a Bayesian network structure, $P$ factorizes according to $\\mathcal{G}$, $P$ is specified as a set of CPDs associated with $\\mathcal{G}$’s nodes. Bayesian Network Structure A Bayesian network structure (or Bayesian network graph, BN graph) is a DAG, denoted $\\mathcal{G}=(\\mathcal{X},\\mathcal{E})$ with $\\mathcal{X}=\\{X_1,\\ldots,X_n\\}$ where\nEach node $X_i\\in\\mathcal{X}$ represents a random variable. Each node $X_i\\in\\mathcal{X}$ is associated with a conditional independencies assumption, called local independencies, denoted $\\mathcal{I}_\\ell(\\mathcal{G})$, which says that $X_i$ is conditionally independent of its non-descendants given its parent, i.e. \\begin{equation} (X_i\\perp\\text{NonDescendants}_{X_i}\\vert\\hspace{0.1cm}\\text{Pa}_{X_i}), \\end{equation} where $\\text{NonDescendants}_{X_i}$ denotes the set of non-descendant nodes of $X_i$. I-Maps Let $P$ be a distribution over $\\mathcal{X}$, we define $\\mathcal{I}(P)$ to be the set of independence assertions of the form $(X\\perp Y\\hspace{0.1cm}\\vert Z)$ that hold in $P$, i.e. \\begin{equation} P\\models(X\\perp Y\\vert Z), \\end{equation} or \\begin{equation} P(X,Y\\vert Z)=P(X\\vert Z)P(Y\\vert Z) \\end{equation} Let $\\mathcal{K}$ be a graph associated with a set of independencies $\\mathcal{I}(\\mathcal{K})$, then $\\mathcal{K}$ is an I-map (for independence map) for a set of independencies $\\mathcal{I}$ if $\\mathcal{I}(\\mathcal{K})\\subset\\mathcal{I}$.\nHence, if $P$ satisfies the local dependencies associated with $\\mathcal{G}$, we have \\begin{equation} \\mathcal{I}_\\ell(\\mathcal{G})\\subset\\mathcal{I}(P), \\end{equation} which implies that $\\mathcal{G}$ is an I-map for $\\mathcal{I}(P)$, or simply an I-map for $P$.\nFactorization Let $\\mathcal{G}$ is a BN graph over $X_1,\\ldots,X_n\\in\\mathcal{X}$. A distribution $P$ over $\\mathcal{X}$ is said to factorize according to $\\mathcal{G}$ if $P$ can be expressed as a product \\begin{equation} P(X_1,\\ldots,X_n)=\\prod_{i=1}^{n}P(X_i\\vert\\text{Pa}_{X_i}) \\end{equation} This equation is known as the chain rule for Bayesian networks. Each individual factor $P(X_i\\vert\\text{Pa}_{X_i})$, which is a conditional probability distribution (CPD), is called the local probabilistic model.\nI-Map - Factorization Connection Theorem 1: Let $\\mathcal{G}$ be a BN graph over a set of random variables $\\mathcal{X}$ and let $P$ be a joint distribution over $\\mathcal{X}$. Then $\\mathcal{G}$ is an I-map for $P$ if and only if $P$ factorizes over $\\mathcal{G}$.\nProof\nI-map $\\Rightarrow$ Factorization\nWithout loss of generality, let $X_1,\\ldots,X_n$ be a topological ordering of the variables in $\\mathcal{X}$.\nLet us consider an arbitrary $X_i$ for $i\\in\\{1,\\ldots,n\\}$. As mentioning above, the topological ordering implies that \\begin{align} \\text{Pa}_{X_i}\u0026\\subset\\{X_1,\\ldots,X_{i-1}\\}, \\\\ \\text{Ch}_{X_i}\u0026\\subset\\{X_{i+1},\\ldots,X_n\\} \\end{align} Consequently, none of descendants of $X_i$ is in $\\{X_1,\\ldots,X_{n-1}\\}$. Thus, if we denote the set of all non-descendant nodes of $X_i$ as $\\text{NonDescentdants}_{X_i}$ and let $\\mathbf{Z}\\subset\\text{NonDescentdants}_{X_i}$, then \\begin{equation} \\mathbf{Z}\\cup\\text{Pa}_{X_i}=\\{X_1,\\ldots,X_{i-1}\\} \\end{equation} Moreover, the local independence for $X_i$ implies that \\begin{equation} (X_i\\perp\\mathbf{Z}\\vert\\text{ Pa}_{X_i}) \\end{equation} Therefore, since $\\mathcal{G}$ is an I-map for $P$ we obtain \\begin{equation} P(X_i\\vert X_1,\\ldots,X_{i-1})=P(X_i\\vert\\text{Pa}_{X_i}) \\end{equation} Thus, by the chain rule for probabilities, we have \\begin{equation} P(X_1,\\ldots,X_n)=\\prod_{i=1}^{n}P(X_i\\vert X_1,\\ldots,X_{i-1})=\\prod_{i=1}^{n}P(X_i\\vert\\text{Pa}_{X_i}) \\end{equation} I-map $\\Leftarrow$ Factorization\nTo prove that $\\mathcal{G}$ is an I-map according to $P$, we need to show that $\\mathcal{I}_\\ell(\\mathcal{G})$ holds in $P$. Consider an arbitrary node $X_i$ and the local independencies $(X_i\\perp\\text{NonDescendants}_{X_i}\\vert\\text{Pa}_{X_i})$, our problem remains to prove that \\begin{equation} P(X_i\\vert\\mathcal{X}\\backslash X_i)=P(X_i\\vert\\text{Pa}_{X_i}) \\end{equation} since \\begin{equation} P(X_i\\vert\\mathcal{X}\\backslash X_i)=P(X_i\\vert\\text{NonDescendants}_{X_i}\\cup\\text{Pa}_{X_i}) \\end{equation} By factorization, we have that \\begin{align} P(\\mathcal{X}\\backslash X_i)\u0026=\\sum_{X_i}P(X_1,\\ldots,X_n) \\\\ \u0026=\\sum_{X_i}\\prod_{j=1}^{n}P(X_j\\vert\\text{Pa}_{X_j}) \\\\ \u0026=\\left(\\prod_{j=1,j\\neq i}^{n}P(X_j\\vert\\text{Pa}_{X_j})\\right)\\sum_{X_i}P(X_i\\vert\\text{Pa}_{X_i}) \\\\ \u0026=\\prod_{j=1,j\\neq i}^{n}P(X_j\\vert\\text{Pa}_{X_j}), \\end{align} where in the last step, we use the fact that the conditional probability function $P(X_i\\vert\\text{Pa}_{X_i})$ sum to $1$ over the sample space of $X_i$. This implies that by Bayes rules \\begin{align} P(X_i\\vert\\mathcal{X}\\backslash X_i)\u0026=\\frac{P(X_1,\\ldots,X_n)}{P(\\mathcal{X}\\backslash X_i)} \\\\ \u0026=\\frac{\\prod_{j=1}^{n}P(X_j\\vert\\text{Pa}_{X_j})}{\\prod_{j=1,j\\neq i}^{n}P(X_j\\vert\\text{Pa}_{X_j})} \\\\ \u0026=P(X_i\\vert\\text{Pa}_{X_i}) \\end{align} Independencies in Bayesian Network D-separation Let $\\mathcal{G}$ be a BN structure, $X_1\\rightleftharpoons\\ldots\\rightleftharpoons X_n$ be a trail in $\\mathcal{G}$ and let $\\mathbf{Z}$ be a subset of observed variables. The trail $X_1\\rightleftharpoons\\ldots\\rightleftharpoons X_n$ is active if\nWhenever we have a v-structure $X_{i-1}\\rightarrow X_i\\leftarrow X_{i+1}$, $X_i$ or one of its descendants are in $\\mathbf{Z}$; No other node along the trail are in $\\mathbf{Z}$. Figure 2: (taken from the PGM book) The four possible two-edge trails from $X$ to $Y$ via $Z$: (a) Causal trail; (b) Evidential trail; (c) Common cause trail; (d) Common effect trail Consider the trails forming from two edges as illustrated above:\nThe trail $X\\rightarrow Z\\rightarrow Y$ is active $\\Leftrightarrow$ $Z$ is not observed. The trail $X\\leftarrow Z\\leftarrow Y$ is active $\\Leftrightarrow$ $Z$ is not observed. The trail $X\\leftarrow Z\\leftarrow Y$ is active $\\Leftrightarrow$ $Z$ is not observed. The trail $X\\rightarrow Z\\leftarrow Y$ is active $\\Leftrightarrow$ either $Z$ or one of its descendants is observed. Let $\\mathbf{X},\\mathbf{Y},\\mathbf{Z}$ be sets of nodes in $\\mathcal{G}$. Then $\\mathbf{X}$ and $\\mathbf{Y}$ are said to be d-separated given $\\mathbf{Z}$, denoted $\\text{d-sep}_\\mathcal{G}(\\mathbf{X};\\mathbf{Y}\\vert\\mathbf{Z})$, if there is no active trail between any node $X\\in\\mathbf{X}$ and $Y\\in\\mathbf{Y}$ given $\\mathbf{Z}$.\nWe define the global Markov independencies associated with $\\mathcal{G}$, denoted $\\mathcal{I}(\\mathcal{G})$, to be the set of all independencies that correspond to d-separation in $\\mathcal{G}$ \\begin{equation} \\mathcal{I}(\\mathcal{G})=\\big\\{(\\mathbf{X}\\perp\\mathbf{Y}\\vert\\mathbf{Z}):\\text{d-sep}_\\mathcal{G}(\\mathbf{X};\\mathbf{Y}\\vert\\mathbf{Z})\\big\\} \\end{equation}\nSoundness, Completeness Theorem 2 (Soundness of d-separation) If a distribution $P$ factorizes according to $\\mathcal{G}$, then \\begin{equation} \\mathcal{I}(\\mathcal{G})\\subset\\mathcal{I}(P) \\end{equation} The soundness property says that if $\\text{d-sep}_\\mathcal{G}(X;Y\\vert\\mathbf{Z})$ then they are conditional independent given $\\mathbf{Z}$, or $(X\\perp Y\\vert\\mathbf{Z})$.\nTheorem 3 (Completeness of d-separation) If two variables $X$ and $Y$ are independent given $\\mathbf{Z}$, then they are d-separated.\nThe completeness property says that d-separation detects all possible independencies.\nTheorem 4: Let $\\mathcal{G}$ be a BN graph. If $X$ and $Y$ are not d-separated given $\\mathbf{Z}$, then $X$ and $Y$ are dependent given $\\mathbf{Z}$ in some distribution $P$ that factorizes over $\\mathcal{G}$.\nTheorem 5: For almost all distributions $P$ that factorize over $\\mathcal{G}$, i.e. for all distributions except for a set of measure zero in the space of CPD parameterizations, we have that \\begin{equation} \\mathcal{I}(\\mathcal{G})=\\mathcal{I}(P) \\end{equation} These results state that for almost all parameterizations $P$ of the graph $\\mathcal{G}$, the d-separation test precisely characterizes the independencies that hold for $P$.\nI-Equivalence Two graph $\\mathcal{K}_1$ and $\\mathcal{K}_2$ over $\\mathcal{X}$ are said to be I-equivalent if they encode the same set of conditional independencies assertions, i.e. \\begin{equation} \\mathcal{I}(\\mathcal{K}_1)=\\mathcal{I}(\\mathcal{K}_2) \\end{equation} This implies that any distribution $P$ that factorizes over $\\mathcal{K}_1$ also factorizes according to $\\mathcal{K}_2$ and vice versa.\nThe skeleton of a BN graph $\\mathcal{G}$ over $\\mathcal{X}$ is an undirected graph over $\\mathcal{X}$ containing an edge $\\{X,Y\\}$ for every edge $(X,Y)$ in $\\mathcal{G}$.\nTheorem 6 (skeleton + v-structures $\\Rightarrow$ I-equivalence) Let $\\mathcal{G}_1$ and $\\mathcal{G_2}$ be two graphs over $\\mathcal{X}$. If $\\mathcal{G}_1,\\mathcal{G}_2$ both have the same skeleton and the same set of v-structures then they are I-equivalent.2\nFigure 3: (taken from the PGM book) Two graphs have the same skeleton and set of v-structures, i.e. $\\{X\\rightarrow Y\\leftarrow Z\\}$, and thus are I-equivalent Immorality A v-structure $X\\rightarrow Z\\leftarrow Y$ is an immorality if there is no direct edge between. If there is such an edge, it is called a covering edge for the v-structure.\nIt is easily seen that not every v-structure is an immorality, which implies that two networks with the same set of immoralities do not necessarily have the same set of v-structures.\nTheorem 7 (skeleton + immoralities $\\Leftrightarrow$ I-equivalence) Let $\\mathcal{G}_1$ and $\\mathcal{G_2}$ be two graphs over $\\mathcal{X}$. If $\\mathcal{G}_1,\\mathcal{G}_2$ both have the same skeleton and the same set of immoralities iff they are I-equivalent.\nProof\nTo prove the theorem, we first introduce the notion of minimal active trail and triangle.\nDefinition (Minimal active trail) An active trail $X_1,\\ldots,X_m$ is minimal if there is no other active trail from $X_1$ to $X_m$ that shortcuts some of the nodes, i.e. there is no active trail \\begin{equation} X_1\\rightleftharpoons X_{i_1}\\rightleftharpoons\\ldots X_{i_k}\\rightleftharpoons X_m\\hspace{1cm}\\text{for }1\\lt i_1\\lt\\ldots\\lt i_k\\lt m \\end{equation} Definition (Triangle) Any three consecutive nodes in a trail $X_1,\\ldots,X_m$ are called a triangle if their skeleton is fully connected, i.e. forms a 3-clique.\nOur attention now is to prove that the only possible triangle in minimal active trail is the one having form of $X_{i-1}\\leftarrow X_i\\rightarrow X_{i+1}$ and either $X_{i-1}\\rightarrow X_{i+1}$ or $X_{i-1}\\leftarrow X_{i+1}$.\nConsider a two-edge trail from $X_{i-1}$ to $X_{i+1}$ via $X_i$, which as being mentioned above, has four possible forms $X_{i-1}\\rightarrow X_i\\rightarrow X_{i+1}$\nIt is easily seen that $X_i$ has to be not observed to make the trail active. If $X_{i-1}$ is connected to $X_{i+1}$ via $X_{i-1}\\rightarrow X_{i+1}$, this gives rise to a shortcut. On the other hand, if they are connected by $X_{i-1}\\leftarrow X_{i+1}$, the triangle now induces a cycle. $X_{i-1}\\leftarrow X_i\\leftarrow X_{i+1}$\nThis case is symmetrically identical to the previous one, and thus is not viable. $X_{i-1}\\leftarrow X_i\\rightarrow X_{i+1}$\nThe first observation is that $X_i$ has to be not given. The second observation is $X_{i-1}$ and $X_{i+1}$ are symmetric through $X_i$, so we only need to consider some specific cases of $X_{i-1}$ and the same logic is applied to $X_{i+1}$ analogously.\nLet us examine the two-edge trail $X_{i-2},X_{i-1},X_i$. On the one hand, if we have $X_{i-2}\\rightarrow X_{i-1}$, $X_{i-1}$ then has to be given, which implies that If $X_{i-1}\\leftarrow X_{i+1}$ exists, it will create a shortcut, which is not allowed. If $X_{i-1}\\rightarrow X_{i+1}$ exists, no shortcut appears, $X_{i-1},X_i,X_{i+1}$ satisfies the condition of a triangle in the minimal active trail $X_1,\\ldots,X_m$. On the other hand, if we have $X_{i-2}\\leftarrow X_{i-1}$, then $X_{i-1}$ is not observed, analogously, we instead have If $X_{i-1}\\leftarrow X_{i+1}$ exists, no shortcut is formed, $X_{i-1},X_i,X_{i+1}$ create a triangle. If $X_{i-1}\\rightarrow X_{i+1}$ exists, $X_{i-1},X_i,X_{i+1}$ is do not form a triangle due to the appearance of a shortcut through $X_{i-1}$ to $X_{i+1}$. $X_{i-1}\\rightarrow X_i\\leftarrow X_{i+1}$\nIn this case, $X_i$ or one of its descendant is observed. Using the similar procedure to previous case gives us no viable triangle formed by $X_{i-1},X_i,X_{i+1}$. Given these results, we are now ready for the main part. Let us begin with the forward path. Skeleton + Immoralities $\\Rightarrow$ I-equivalence\nAssume that there exists node $X,Y,Z$ such that \\begin{align} (X\\perp Y\\vert Z)\u0026\\in\\mathcal{I}(\\mathcal{G}_1), \\\\ (X\\perp Y\\vert Z)\u0026\\not\\in\\mathcal{I}(\\mathcal{G}_2), \\end{align} which implies that there is an active trail through $X,Y$ and $Z$ in the graph $\\mathcal{G}_2$. Let us consider the minimal one and continue by examining two cases that whether $Z$ is observed. If $Z$ is observed, in $\\mathcal{G}_1$, we have $X\\rightarrow Z\\rightarrow Y$, or $X\\leftarrow Z\\leftarrow Y$, or $X\\leftarrow Z\\rightarrow Y$, while we have $X\\rightarrow Z\\leftarrow Y$ in $\\mathcal{G}_2$, which is a v-structure. To assure that both graphs have the same set of moralities, there exist an edge that directly connects $X$ and $Y$, or in other words, $X,Y,Z$ form a triangle. This contradicts to the claim we have proved in the previous part. If $Z$ is not observed, thus in $\\mathcal{G}_1$, $X,Y,Z$ now must form a v-structure $X\\rightarrow Z\\leftarrow Y$. And also, to guarantee that both graphs have the same moralities, there exists an edge, without loss of generality, we assume $X\\rightarrow Y$. However, this edge will active the trail $X,Y,Z$, or in other words, in $\\mathcal{G}_1$, we now have $(X\\not\\perp Y\\vert Z)$, which is a contradiction of our assumption. Skeleton + Immoralities $\\Leftarrow$ I-equivalence\nConsider two I-equivalent graphs $\\mathcal{G}_1$ and $\\mathcal{G}_2$. First assuming that they do not have that same skeleton. This implies without loss of generality that there exists a trail in $\\mathcal{G}_1$ that does not appear in $\\mathcal{G}_2$, which induces a conditional independence in $\\mathcal{G}_1$ but not in $\\mathcal{G}_2$, contradicts to the fact that they two graphs are I-equivalent. Now assuming that two graphs do not have the same set of moralities. Undirected Graphical Model Similar to the directed case, each node in an undirected graphical model represents a random variable. However, as indicated from the name, each edge that connects two nodes is now undirected, and thus can not describe causal relationship between those nodes as in Bayesian network.\nMarkov Random Fields An Undirected Graphical Model (or Markov Random Field, or Markov network) represents a probability distribution $P$ over variables $X_1,\\ldots,X_n$ defined by an undirected graph $\\mathcal{H}$ in which each node correspond to a variable $X_i$, and a set of positive potential functions $\\psi_c$ associated with the cliques of $\\mathcal{H}$ such that \\begin{equation} P(X_1,\\ldots,X_n)=\\frac{1}{Z}\\prod_{c\\in C}\\psi_c(X_c),\\label{eq:mrf.1} \\end{equation} where\n$P$ is also called a Gibbs distribution $C$ denotes the set of cliques of $\\mathcal{H}$ $X_c$ represents the set of nodes within clique $c$ $Z$ is known as the partition function, given by \\begin{equation} Z=\\sum_{X_1,\\ldots,X_n}\\prod_{c\\in C}\\psi_c(X_c) \\end{equation} From the above definition, we say that a distribution $P$ is a Gibbs distribution that factorizes over $\\mathcal{H}$ if it can be expressed as a normalized product over all potential functions defined on the cliques of $\\mathcal{H}$, as in \\eqref{eq:mrf.1}.\nIndependencies in Markov Network Analogy to Bayesian network, the graph structure in a Markov Random Field can be viewed as encoding a set of independence assumptions, which can be specified by considering the undirected paths through nodes.\nSeparation Let $\\mathcal{H}$ be a Markov network structure and let $X_1-\\ldots-X_k$ be a path in $\\mathcal{H}=(\\mathcal{X},\\mathcal{E})$. Let $\\mathbf{Z}\\subset\\mathcal{X}$ be a set of observed variables. Then $X_1-\\ldots-X_k$ is active given $\\mathbf{Z}$ if none of $X_1,\\ldots,X_k$ is in $\\mathbf{Z}$.\nLet $\\mathbf{X},\\mathbf{Y}$ be set of nodes in $\\mathcal{H}$. We say that $\\mathbf{Z}$ separates $\\mathbf{X}$ and $\\mathbf{Y}$, denoted $\\text{sep}_\\mathcal{H}(\\mathbf{X};\\mathbf{Y}\\vert\\mathbf{Z})$ if there is no active path between any node $X\\in\\mathbf{X}$ and $Y\\in\\mathbf{Y}$ given $\\mathbf{Z}$.\nGlobal Markov Independencies As in the case of Bayesian network, we define the global Markov independencies associated with $\\mathcal{H}$, denoted $\\mathcal{I}(\\mathcal{H})$, to be the set of all independencies correspond to separation in $\\mathcal{H}$ \\begin{equation} \\mathcal{I}(\\mathcal{H})=\\big\\{(\\mathbf{X}\\perp\\mathbf{Y}\\vert\\mathbf{Z}):\\text{sep}_\\mathcal{H}(\\mathbf{X};\\mathbf{Y}\\vert\\mathbf{Z})\\big\\} \\end{equation}\nLocal Markov Independencies Let $\\mathcal{H}$ be a Markov network. We define the pairwise independencies associated with $\\mathcal{H}$ to be \\begin{equation} \\mathcal{I}_p(\\mathcal{H})=\\big\\{(X\\perp Y\\vert\\mathcal{X}\\backslash\\{X,Y\\}):X-Y\\notin\\mathcal{H}\\big\\} \\end{equation} Or in other words, the pairwise independencies states that $X$ and $Y$ are independent given all other nodes in $\\mathcal{H}$.\nFor a given graph $\\mathcal{H}$ and for an arbitrary node $X$ of $\\mathcal{H}$, the set of neighbors of $X$ is also called the Markov blanket of $X$, denoted $\\text{MB}_\\mathcal{H}(X)$. With this notion, we define the local independencies, or Markov local independencies, associated with $\\mathcal{H}$ to be \\begin{equation} \\mathcal{I}_\\ell(\\mathcal{H})=\\big\\{\\big(X\\perp\\mathcal{X}\\backslash(\\{X\\}\\cup\\text{MB}_\\mathcal{H}(X))\\vert\\text{MB}_\\mathcal{H}(X)\\big):X\\in\\mathcal{X}\\big\\} \\end{equation} Or in other words, the Markov local independencies says that $X$ is independent of the rest of the nodes in $\\mathcal{H}$ given its neighbors.\nMarkov Independencies Relationships Theorem 8: Let $\\mathcal{H}$ be a Markov network and $P$ be a positive distribution. The following three statement are then equivalent:\n$P\\models\\mathcal{I}_\\ell(\\mathcal{H})$. $P\\models\\mathcal{I}_p(\\mathcal{H})$. $P\\models\\mathcal{I}(\\mathcal{H})$. Proof\n(i) $\\Rightarrow$ (ii)\nConsider an arbitrary node $X$ in $\\mathcal{H}$. Let $Y\\in\\mathcal{X}$ such that $X-Y\\notin\\mathcal{H}$, then $Y\\notin\\text{MB}_\\mathcal{H}(X)$, or in other words \\begin{equation} Y\\in\\mathcal{X}\\backslash(\\{X\\}\\cup\\text{MB}_\\mathcal{H}(X)) \\end{equation} Moreover, since $P\\models\\mathcal{I}_\\ell(\\mathcal{H})$, we have that $P$ satisfies \\begin{equation} \\big(X\\perp\\mathcal{X}\\backslash(\\{X\\}\\cup\\text{MB}_\\mathcal{H}(X))\\vert\\text{MB}_\\mathcal{H}(X)\\big), \\end{equation} which implies that \\begin{equation} \\big(X\\perp Y\\vert\\text{MB}_\\mathcal{X}\\cup\\mathcal{X}\\backslash(\\{X,Y\\}\\cup\\text{MB}_\\mathcal{H}(X))\\big) \\end{equation} holds for $P$. Or in other words, for any $X,Y$ such that $X-Y\\notin\\mathcal{H}$, we have \\begin{equation} P\\models(X\\perp Y\\vert\\mathcal{X}\\backslash\\{X,Y\\}), \\end{equation} which proves our claim. (ii) $\\Rightarrow$ (iii)\nConsider arbitrary non-empty subsets $\\mathbf{X},\\mathbf{Y},\\mathbf{Z}$ of $\\mathcal{X}$. We need to show that \\begin{equation} \\text{sep}_\\mathcal{H}(\\mathbf{X};\\mathbf{Y}\\vert\\mathbf{Z})\\Rightarrow P\\models(\\mathbf{X}\\perp\\mathbf{Y}\\vert\\mathbf{Z})\\label{eq:mir.1} \\end{equation} We will be using induction to prove the claim. Specifically, first consider the case that $\\vert\\mathbf{Z}\\vert=\\vert\\mathcal{X}\\vert-2=n-2$, which implies that $\\vert\\mathbf{X}\\vert=\\vert\\mathbf{Y}\\vert=1$. Hence, \\eqref{eq:mir.1} follows directly from definition of $\\mathcal{I}_p(\\mathcal{H})$. (iii) $\\Rightarrow$ (i)\nConsider arbitrary disjoint subsets $\\mathbf{X},\\mathbf{Y},\\mathbf{Z}$ of $\\mathcal{X}$ such that \\begin{equation} \\text{sep}_\\mathcal{H}(\\mathbf{X};\\mathbf{Y}\\vert\\mathbf{Z}) \\end{equation} We will be examining two cases. First, consider the case that $\\mathbf{X}\\cup\\mathbf{Y}\\cup\\mathbf{Z}=\\mathcal{X}$. Soundness, Completeness Theorem 9 (Soundness of separation) Let $\\mathcal{H}=(\\mathcal{X},\\mathcal{E})$ be a Markov network structure and let $P$ be a distribution over $\\mathcal{X}$. If $P$ is a Gibbs distribution that factorizes over $\\mathcal{H}$, then $\\mathcal{H}$ is an I-map for $P$.\nProof\nLet $\\mathbf{X},\\mathbf{Y}$ and $\\mathbf{Z}$ be any disjoint subsets of $\\mathcal{X}$ such that $\\text{sep}_\\mathcal{H}(\\mathbf{X};\\mathbf{Y}\\vert\\mathbf{Z})$. We need to show that \\begin{equation} P\\models(\\mathbf{X}\\perp\\mathbf{Y}\\vert\\mathbf{Z}) \\end{equation} We begin by considering the case that $\\mathbf{X}\\cup\\mathbf{Y}\\cup\\mathbf{Z}=\\mathcal{X}$. Since $\\mathbf{Z}$ separates $\\mathbf{X}$ and $\\mathbf{Y}$, then for any $X\\in\\mathbf{X}$ and for any $Y\\in\\mathbf{Y}$, there is no direct edge between $X,Y$. This implies that any clique in $\\mathcal{H}$ is either in $\\mathbf{X}\\cup\\mathbf{Z}$ or in $\\mathbf{Y}\\cup\\mathbf{Z}$.\nLet $C_\\mathbf{X}$ denote the set of cliques within $\\mathbf{X}\\cup\\mathbf{Z}$ and let $C_\\mathbf{Y}$ represent the set of cliques in $\\mathbf{Y}\\cup\\mathbf{Z}$. Thus, as $P$ factorizes over $\\mathcal{H}$, we have that \\begin{align} P(X_1,\\ldots,X_n)\u0026=\\frac{1}{Z}\\left(\\prod_{c\\in C_\\mathbf{X}}\\psi(X_c)\\right)\\left(\\prod_{c\\in C_\\mathbf{Y}}\\psi(X_c)\\right) \\\\ \u0026=\\frac{1}{Z}\\psi_\\mathbf{X}(\\mathbf{X},\\mathbf{Z})\\psi_\\mathbf{Y}(\\mathbf{Y},\\mathbf{Z}), \\end{align} where $\\psi_\\mathbf{X},\\psi_\\mathbf{Y}$ are some factor with scopes $\\mathbf{X}\\cup\\mathbf{Z}$ and $\\mathbf{Y}\\cup\\mathbf{Z}$ respectively. Hence, it follows that \\begin{equation} P\\models(\\mathbf{X}\\perp\\mathbf{Y}\\vert\\mathbf{Z}) \\end{equation} Now consider the case that $\\mathbf{X}\\cup\\mathbf{Y}\\cup\\mathbf{Z}\\subset\\mathcal{X}$. Let $\\mathbf{U}=\\mathcal{X}\\backslash(\\mathbf{X}\\cup\\mathbf{Y}\\cup\\mathbf{Z})$. We can divide $\\mathbf{U}$ into two disjoint sets $\\mathbf{U}_1$ and $\\mathbf{U}_2$ such that \\begin{equation} \\text{sep}_\\mathcal{H}(\\mathbf{X}\\cup\\mathbf{U}_1;\\mathbf{Y}\\cup\\mathbf{U}_2\\vert\\mathbf{Z}) \\end{equation} And since $(\\mathbf{X}\\cup\\mathbf{U}_1)\\cup(\\mathbf{Y}\\cup\\mathbf{U}_2)\\cup\\mathbf{Z}=\\mathcal{X}$, we can follow the previous procedure to conclude that \\begin{equation} P\\models(\\mathbf{X}\\cup\\mathbf{U}_1\\perp\\mathbf{Y}\\cup\\mathbf{U}_2\\vert\\mathbf{Z}), \\end{equation} which implies that \\begin{equation} P\\models(\\mathbf{X}\\perp\\mathbf{Y}\\vert\\mathbf{Z}) \\end{equation}\nTheorem 10 (Hammersley-Clifford) Let $\\mathcal{H}=(\\mathcal{X},\\mathcal{E})$ be a Markov network structure and let $P$ be a positive distribution over $\\mathcal{X}$. If $\\mathcal{H}$ is an I-map for $P$, then $P$ is a Gibbs distribution that factorizes over $\\mathcal{H}$.\nCorollary 11 The positive distribution $P$ factorizes a Markov network $\\mathcal{H}$ iff $\\mathcal{H}$ is an I-map for $P$.\nTheorem 12 (Completeness of separation) Let $\\mathcal{H}$ be a Markov network structure. If $X$ and $Y$ are not separated given $\\mathbf{Z}$ in $\\mathcal{H}$, then $X$ and $Y$ are dependent given $\\mathbf{Z}$ in some distribution $P$ that factorizes over $\\mathcal{H}$.\nReferences [1] Daphne Koller, Nir Friedman. Probabilistic Graphical Models. The MIT Press.\n[2]\n[3] Eric P.Xing 10-708: Probabilistic Graphical Model. CMU Spring 2019.\n[4] CS228: Probabilistic Graphical Model. Stanford 2017.\nFootnotes Note that $X_i\\rightarrow X_j\\equiv X_j\\leftarrow X_i$ but $X_i\\rightarrow X_j\\not\\equiv X_i\\leftarrow X_j$, while $X_i-X_j\\equiv X_j-X_i$. ↩︎\nNote that the inverse is not true. ↩︎\n","wordCount":"3561","inLanguage":"en","datePublished":"2022-12-10T17:55:57+07:00","dateModified":"2022-12-10T17:55:57+07:00","author":{"@type":"Person","name":"Trung H. Nguyen"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://trunghng.github.io/posts/machine-learning/pgm-representation/"},"publisher":{"@type":"Organization","name":"Trung's Place","logo":{"@type":"ImageObject","url":"https://trunghng.github.io/images/favicon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://trunghng.github.io accesskey=h title="Trung's Place (Alt + H)"><img src=https://trunghng.github.io/images/others/pokeball.png alt aria-label=logo height=27>Trung's Place</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://trunghng.github.io/ title=Posts><span>Posts</span></a></li><li><a href=https://trunghng.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://trunghng.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://trunghng.github.io/about/ title=About><span>About</span></a></li><li><a href=https://trunghng.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Probabilistic Graphical Model - Representation</h1><div class=post-meta><span title='2022-12-10 17:55:57 +0700 +0700'>December 10, 2022</span>&nbsp;·&nbsp;17 min&nbsp;·&nbsp;Trung H. Nguyen</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#graphs>Graphs</a><ul><li><a href=#nodes-edges>Nodes, Edges</a></li><li><a href=#subgraphs>Subgraphs</a></li><li><a href=#paths-trails>Paths, Trails</a></li><li><a href=#cycles-loops>Cycles, Loops</a></li></ul></li><li><a href=#dgm>Directed Graphical Model</a><ul><li><a href=#bayesian-network-structure>Bayesian Network Structure</a></li><li><a href=#i-maps>I-Maps</a></li><li><a href=#factorization>Factorization</a></li><li><a href=#i-map---factorization-connection>I-Map - Factorization Connection</a></li><li><a href=#independencies-in-bayesian-network>Independencies in Bayesian Network</a><ul><li><a href=#d-separation>D-separation</a></li><li><a href=#soundness-completeness-bn>Soundness, Completeness</a></li><li><a href=#i-equivalence>I-Equivalence</a><ul><li><a href=#immorality>Immorality</a></li></ul></li></ul></li></ul></li><li><a href=#ugm>Undirected Graphical Model</a><ul><li><a href=#mrf>Markov Random Fields</a></li><li><a href=#independencies-in-markov-network>Independencies in Markov Network</a><ul><li><a href=#separation>Separation</a></li><li><a href=#global-markov-independencies>Global Markov Independencies</a></li><li><a href=#local-markov-independencies>Local Markov Independencies</a></li><li><a href=#markov-independencies-relationships>Markov Independencies Relationships</a></li><li><a href=#soundness-completeness>Soundness, Completeness</a></li></ul></li></ul></li><li><a href=#references>References</a></li><li><a href=#footnotes>Footnotes</a></li></ul></nav></div></details></div><div class=post-content><p>Notes on Bayesian Networks and Markov Random Fields.</p><h2 id=graphs>Graphs<a hidden class=anchor aria-hidden=true href=#graphs>#</a></h2><p>A <strong>graph</strong>, denoted $\mathcal{K}$ is a tuple of $\mathcal{X}$ and $\mathcal{E})$ where $\mathcal{X}=\{X_1,\ldots,X_n\}$ is the sets of <strong>nodes</strong> (or <strong>vertices</strong>) and $\mathcal{E}$ is the set of <strong>edges</strong>.
\begin{equation}
\mathcal{K}=(\mathcal{X},\mathcal{E})
\end{equation}</p><h3 id=nodes-edges>Nodes, Edges<a hidden class=anchor aria-hidden=true href=#nodes-edges>#</a></h3><p>Any pair of nodes $X_i,X_j$, for $i\neq j$ is connected by either a <strong>directed edge</strong> $X_i\rightarrow X_j$ or an <strong>undirected edge</strong> $X_i-X_j$<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. We use the notation $X_i\rightleftharpoons X_j$ to denote that $X_i$ is connected to $X_j$ via some edge, whether directed (in any direction) or undirected.</p><p>If the graph contains directed edges only, we call it a <strong>directed graph</strong>, denoted $\mathcal{G}$, else if the graph established by undirected edge only, it is referred as <strong>undirected graph</strong>, denoted $\mathcal{H}$.</p><figure><img src=/images/pgm-representation/graph-eg.png alt="Graph example" style=display:block;margin-left:auto;margin-right:auto;width:50%;height:50%><figcaption style=text-align:center;font-style:italic><b>Figure 1</b>: (taken from the <a href=#pgm-book>PGM book</a>) Example of a partially directed graph $\mathcal{K}$</figcaption></figure><p>Following are some necessary notations:</p><ul id=number-list><li>If $X_i\rightarrow X_j\in\mathcal{E}$, we say that $X_i$ is the <b>parent</b> of $X_j$ while $X_j$ is the <b>child</b> of $X_i$.<br>E.g. node $I$ is a child of nodes $C,E$ and $H$ while $D$ is a parent of $G$.</li><li>If $X_i-X_j\in\mathcal{E}$, we say that $X_i$ is a <b id=neighbor>neighbor</b> of $X_j$, and vice versa.<br>E.g. node $F$ is a neighbor of $G$.</li><li>If $X\rightleftharpoons Y\in\mathcal{E}$, we say that $X$ and $Y$ are adjacent.<br>E.g. nodes $A$ and $C$ are adjacent, while $D$ is adjacent to $E$.</li><li>We use $\text{Pa}_X$ to denote the set of parents of $X$, $\text{Ch}_X$ to denote the set of its children and $\text{Nb}_X$ to denote its neighbors. The set $\text{Boundary}_X\doteq\text{Pa}_X\cup\text{Nb}_X$ is known as the <b>boundary</b> of $X$.<br>E.g. $\text{Pa}_I=\{C,E,H\}$ and $\text{Boundary}_F=\text{Pa}_F\cup\text{Nb}_F=\{C\}\cup\{G\}=\{C,G\}$.</li><li>The <b>degree of a node</b> $X$ is the number of edges in which it participates; its <b>indegree</b> is the number of directed edges $Y\rightarrow X$. The <b>degree of a graph</b> is the maximal degree of a node in the graph.<br>E.g. node $D$ has degree of $3$, indegree of $0$; the graph $\mathcal{K}$ has degree of $3$.</li></ul><h3 id=subgraphs>Subgraphs<a hidden class=anchor aria-hidden=true href=#subgraphs>#</a></h3><p>Consider the graph $\mathcal{K}=(\mathcal{X},\mathcal{E})$ and let $\mathbf{X}\subset\mathcal{X}$ be a subset of nodes in $\mathcal{K}$. Then:</p><ul id=number-list><li>The <b>induced subgraph</b> of $\mathcal{K}$, denoted $\mathcal{K}[\mathbf{X}]$ is defined as the graph $(\mathbf{X},\mathcal{E}')$ where
\begin{equation}
\mathcal{E}'=\{X\rightleftharpoons Y:X,Y\in\mathbf{X}\}
\end{equation}</li><li>A subgraph over $\mathbf{X}$ is <b>complete</b> if every two nodes in $\mathbf{X}$ are connected via some edges. The set $\mathbf{X}$ is known as a <b id=clique>clique</b>; or even a <b>maximal clique</b> if for any set of nodes $\mathbf{Y}\supset\mathbf{X}$, $\mathbf{Y}$ is not a clique, i.e.
\begin{equation}
\{\mathbf{Y}\text{ clique}:\mathbf{Y}\supset\mathbf{X}\}=\emptyset
\end{equation}</li><li>The set $\mathbf{X}$ is called <b>upward closed</b> in $\mathbf{K}$ if for any $X\in\mathbf{X}$, we have that
\begin{equation}
\text{Boundary}_X\subset\mathbf{X}
\end{equation}
The <b>upward closure</b> of $\mathbf{X}$ is the minimal closed subset $\mathbf{Y}$ covering $\mathbf{X}$, i.e.
\begin{equation}
\mathbf{Y}=\sup\{\bar{\mathbf{Y}}\text{ upward closed in }\mathcal{K}:\bar{\mathbf{Y}}\supset\mathbf{X}\}
\end{equation}
The <b>upwardly closed subgraph</b> of $\mathbf{X}$, denoted $\mathcal{K}^+[\mathbf{X}]$, is the induced subgraph over $\mathbf{Y}$, $\mathcal{K}[\mathbf{Y}]$.</li></ul><h3 id=paths-trails>Paths, Trails<a hidden class=anchor aria-hidden=true href=#paths-trails>#</a></h3><p>Consider the graph $\mathcal{K}=(\mathcal{X},\mathcal{E})$, the basic notion of edges gives rise to following definitions:</p><ul id=number-list><li>$X_1,\ldots,X_k$ form a <b id=path>path</b> in $\mathcal{K}$ if for every $i=1,\ldots,k-1$, we have that either $X_i\rightarrow X_{i+1}$ or $X_i-X_{i+1}$. A path is <b>directed</b> if there exists a directed edge $X_i\rightarrow X_{i+1}$.</li><li>$X_1,\ldots,X_k$ form a <b>trail</b> in $\mathcal{K}$ if for every $i=1,\ldots,k-1$, we have that $X_i\rightleftharpoons X_{i+1}$.</li><li>$\mathcal{K}$ is <b>connected</b> if for every pair $X_i,X_j$ there is a trail between $X_i$ and $X_j$.</li><li>$X$ is an <b>ancestor</b> of $Y$ and correspondingly $Y$ is a <b>descendant</b> of $X$ in $\mathcal{K}$ if there exists a directed path $X_1,\ldots,X_k$ with $X_1=X$ and $X_k=Y$.</li><li>An ordering of nodes $X_1,\ldots,X_n$ is a <b id=topo-order>topological ordering</b> relative to $\mathbf{K}$ if whenever we have $X_i\rightarrow X_j\in\mathcal{E}$, then $i\lt j$. This gives rise to critical results that for each node $X_i$, we have that
\begin{equation}
\text{Pa}_{X_i}\subset\{X_1,\ldots,X_{i-1}\},
\end{equation}
and
\begin{equation}
\text{Ch}_{X_i}\subset\{X_{i+1},\ldots,X_n\}
\end{equation}</li></ul><h3 id=cycles-loops>Cycles, Loops<a hidden class=anchor aria-hidden=true href=#cycles-loops>#</a></h3><ul id=number-list><li>A <b>cycle</b> in $\mathcal{K}$ is a directed path $X_1,\ldots,X_k$ where $X_1=X_k$. $\mathcal{K}$ is <b>acyclic</b> if it contains no cycles.</li><li>$\mathcal{K}$ is a <b>directed acyclic graph</b> (or <b>DAG</b>) if it is both directed and acyclic.</li><li>An acyclic graph containing both directed and undirected edges is known as a <b>partially directed acyclic graph</b> (or <b>PDAG</b>).<br>Let $\mathcal{K}$ be a PDAG over $\mathcal{X}$ and let $\mathbf{K}_1,\ldots,\mathbf{K}_\ell$ be a disjoint partition of $\mathcal{X}$ such that:<ul id=roman-list><li>the induced subgraph over $\mathbf{K}_i$ contains no directed edges;</li><li>for any pair of nodes $X\in\mathbf{K}_i$ and $Y\in\mathbf{K}_j$ for $i\lt j$, an edge between $X$ and $Y$ can only be a directed edge $X\rightarrow Y$.</li></ul>Each component $\mathbf{K}_i$ is called a <b>chain component</b>, while $\mathcal{K}$ is referred as a <b>chain graph</b>.</li><li>A <b>loop</b> in $\mathcal{K}$ is a trail $X_1,\ldots,X_k$ where $X_1=X_k$. A graph is <b>singly connected</b> if it contains no loops. A node in a singly connected graph is called a <b>leaf</b> if it has exactly one adjacent node.</li><li>A singly connected directed graph is called a <b>polytree</b>, while a singly connected undirected graph is known as a <b>forest</b>; if it is also connected, it is called a <b>tree</b>.</li><li>A directed graph is a <b>forest</b> if each node has at most one parent. A directed forest is a <b>tree</b> if it is also connected.</li></ul><h2 id=dgm>Directed Graphical Model<a hidden class=anchor aria-hidden=true href=#dgm>#</a></h2><p>A <strong>Directed Graphical Model</strong> (or <strong>Bayesian network</strong>) is a tuple $\mathcal{B}=(\mathcal{G},P)$ where</p><ul><li>$\mathcal{G}$ is a <strong>Bayesian network structure</strong>,</li><li>$P$ <strong>factorizes</strong> according to $\mathcal{G}$,</li><li>$P$ is specified as a set of CPDs associated with $\mathcal{G}$&rsquo;s nodes.</li></ul><h3 id=bayesian-network-structure>Bayesian Network Structure<a hidden class=anchor aria-hidden=true href=#bayesian-network-structure>#</a></h3><p>A <strong>Bayesian network structure</strong> (or <strong>Bayesian network graph</strong>, <strong>BN graph</strong>) is a DAG, denoted $\mathcal{G}=(\mathcal{X},\mathcal{E})$ with $\mathcal{X}=\{X_1,\ldots,X_n\}$ where</p><ul id=number-list><li>Each node $X_i\in\mathcal{X}$ represents a random variable.</li><li>Each node $X_i\in\mathcal{X}$ is associated with a conditional independencies assumption, called <b>local independencies</b>, denoted $\mathcal{I}_\ell(\mathcal{G})$, which says that $X_i$ is conditionally independent of its non-descendants given its parent, i.e.
\begin{equation}
(X_i\perp\text{NonDescendants}_{X_i}\vert\hspace{0.1cm}\text{Pa}_{X_i}),
\end{equation}
where $\text{NonDescendants}_{X_i}$ denotes the set of non-descendant nodes of $X_i$.</li></ul><h3 id=i-maps>I-Maps<a hidden class=anchor aria-hidden=true href=#i-maps>#</a></h3><p>Let $P$ be a distribution over $\mathcal{X}$, we define $\mathcal{I}(P)$ to be the set of independence assertions of the form $(X\perp Y\hspace{0.1cm}\vert Z)$ that hold in $P$, i.e.
\begin{equation}
P\models(X\perp Y\vert Z),
\end{equation}
or
\begin{equation}
P(X,Y\vert Z)=P(X\vert Z)P(Y\vert Z)
\end{equation}
Let $\mathcal{K}$ be a graph associated with a set of independencies $\mathcal{I}(\mathcal{K})$, then $\mathcal{K}$ is an <strong>I-map</strong> (for independence map) for a set of independencies $\mathcal{I}$ if $\mathcal{I}(\mathcal{K})\subset\mathcal{I}$.</p><p>Hence, if $P$ satisfies the local dependencies associated with $\mathcal{G}$, we have
\begin{equation}
\mathcal{I}_\ell(\mathcal{G})\subset\mathcal{I}(P),
\end{equation}
which implies that $\mathcal{G}$ is an I-map for $\mathcal{I}(P)$, or simply an I-map for $P$.</p><h3 id=factorization>Factorization<a hidden class=anchor aria-hidden=true href=#factorization>#</a></h3><p>Let $\mathcal{G}$ is a BN graph over $X_1,\ldots,X_n\in\mathcal{X}$. A distribution $P$ over $\mathcal{X}$ is said to <strong>factorize</strong> according to $\mathcal{G}$ if $P$ can be expressed as a product
\begin{equation}
P(X_1,\ldots,X_n)=\prod_{i=1}^{n}P(X_i\vert\text{Pa}_{X_i})
\end{equation}
This equation is known as the <strong>chain rule for Bayesian networks</strong>. Each individual factor $P(X_i\vert\text{Pa}_{X_i})$, which is a conditional probability distribution (CPD), is called the <strong>local probabilistic model</strong>.</p><h3 id=i-map---factorization-connection>I-Map - Factorization Connection<a hidden class=anchor aria-hidden=true href=#i-map---factorization-connection>#</a></h3><p><strong>Theorem 1</strong>: Let $\mathcal{G}$ be a BN graph over a set of random variables $\mathcal{X}$ and let $P$ be a joint distribution over $\mathcal{X}$. Then $\mathcal{G}$ is an I-map for $P$ if and only if $P$ factorizes over $\mathcal{G}$.</p><p><strong>Proof</strong></p><ul id=number-list><li>I-map $\Rightarrow$ Factorization<br>Without loss of generality, let $X_1,\ldots,X_n$ be a <a href=#topo-order>topological ordering</a> of the variables in $\mathcal{X}$.<br>Let us consider an arbitrary $X_i$ for $i\in\{1,\ldots,n\}$. As mentioning above, the topological ordering implies that
\begin{align}
\text{Pa}_{X_i}&\subset\{X_1,\ldots,X_{i-1}\}, \\ \text{Ch}_{X_i}&\subset\{X_{i+1},\ldots,X_n\}
		\end{align}
Consequently, none of descendants of $X_i$ is in $\{X_1,\ldots,X_{n-1}\}$. Thus, if we denote the set of all non-descendant nodes of $X_i$ as $\text{NonDescentdants}_{X_i}$ and let $\mathbf{Z}\subset\text{NonDescentdants}_{X_i}$, then
\begin{equation}
\mathbf{Z}\cup\text{Pa}_{X_i}=\{X_1,\ldots,X_{i-1}\}
\end{equation}
Moreover, the local independence for $X_i$ implies that
\begin{equation}
(X_i\perp\mathbf{Z}\vert\text{ Pa}_{X_i})
\end{equation}
Therefore, since $\mathcal{G}$ is an I-map for $P$ we obtain
\begin{equation}
P(X_i\vert X_1,\ldots,X_{i-1})=P(X_i\vert\text{Pa}_{X_i})
\end{equation}
Thus, by the chain rule for probabilities, we have
\begin{equation}
P(X_1,\ldots,X_n)=\prod_{i=1}^{n}P(X_i\vert X_1,\ldots,X_{i-1})=\prod_{i=1}^{n}P(X_i\vert\text{Pa}_{X_i})
\end{equation}</li><li>I-map $\Leftarrow$ Factorization<br>To prove that $\mathcal{G}$ is an I-map according to $P$, we need to show that $\mathcal{I}_\ell(\mathcal{G})$ holds in $P$. Consider an arbitrary node $X_i$ and the local independencies $(X_i\perp\text{NonDescendants}_{X_i}\vert\text{Pa}_{X_i})$, our problem remains to prove that
\begin{equation}
P(X_i\vert\mathcal{X}\backslash X_i)=P(X_i\vert\text{Pa}_{X_i})
\end{equation}
since
\begin{equation}
P(X_i\vert\mathcal{X}\backslash X_i)=P(X_i\vert\text{NonDescendants}_{X_i}\cup\text{Pa}_{X_i})
\end{equation}
By factorization, we have that
\begin{align}
P(\mathcal{X}\backslash X_i)&=\sum_{X_i}P(X_1,\ldots,X_n) \\ &=\sum_{X_i}\prod_{j=1}^{n}P(X_j\vert\text{Pa}_{X_j}) \\ &=\left(\prod_{j=1,j\neq i}^{n}P(X_j\vert\text{Pa}_{X_j})\right)\sum_{X_i}P(X_i\vert\text{Pa}_{X_i}) \\ &=\prod_{j=1,j\neq i}^{n}P(X_j\vert\text{Pa}_{X_j}),
\end{align}
where in the last step, we use the fact that the conditional probability function $P(X_i\vert\text{Pa}_{X_i})$ sum to $1$ over the sample space of $X_i$. This implies that by Bayes rules
\begin{align}
P(X_i\vert\mathcal{X}\backslash X_i)&=\frac{P(X_1,\ldots,X_n)}{P(\mathcal{X}\backslash X_i)} \\ &=\frac{\prod_{j=1}^{n}P(X_j\vert\text{Pa}_{X_j})}{\prod_{j=1,j\neq i}^{n}P(X_j\vert\text{Pa}_{X_j})} \\ &=P(X_i\vert\text{Pa}_{X_i})
		\end{align}</li></ul><h3 id=independencies-in-bayesian-network>Independencies in Bayesian Network<a hidden class=anchor aria-hidden=true href=#independencies-in-bayesian-network>#</a></h3><h4 id=d-separation>D-separation<a hidden class=anchor aria-hidden=true href=#d-separation>#</a></h4><p>Let $\mathcal{G}$ be a BN structure, $X_1\rightleftharpoons\ldots\rightleftharpoons X_n$ be a trail in $\mathcal{G}$ and let $\mathbf{Z}$ be a subset of observed variables. The trail $X_1\rightleftharpoons\ldots\rightleftharpoons X_n$ is <strong>active</strong> if</p><ul id=roman-list><li>Whenever we have a <b>v-structure</b> $X_{i-1}\rightarrow X_i\leftarrow X_{i+1}$, $X_i$ or one of its descendants are in $\mathbf{Z}$;</li><li>No other node along the trail are in $\mathbf{Z}$.</li></ul><figure><img src=/images/pgm-representation/two-edge-trails.png alt="Two-edge trails" style=display:block;margin-left:auto;margin-right:auto;width:70%;height:70%><figcaption style=text-align:center;font-style:italic><b>Figure 2</b>: (taken from the <a href=#pgm-book>PGM book</a>) The four possible two-edge trails from $X$ to $Y$ via $Z$: (a) Causal trail; (b) Evidential trail; (c) Common cause trail; (d) Common effect trail</figcaption></figure><p><span id=two-edge-trail>Consider the trails forming from two edges as illustrated above</span>:</p><ul id=alpha-list><li>The trail $X\rightarrow Z\rightarrow Y$ is active $\Leftrightarrow$ $Z$ is not observed.</li><li>The trail $X\leftarrow Z\leftarrow Y$ is active $\Leftrightarrow$ $Z$ is not observed.</li><li>The trail $X\leftarrow Z\leftarrow Y$ is active $\Leftrightarrow$ $Z$ is not observed.</li><li>The trail $X\rightarrow Z\leftarrow Y$ is active $\Leftrightarrow$ either $Z$ or one of its descendants is observed.</li></ul><p>Let $\mathbf{X},\mathbf{Y},\mathbf{Z}$ be sets of nodes in $\mathcal{G}$. Then $\mathbf{X}$ and $\mathbf{Y}$ are said to be <strong>d-separated</strong> given $\mathbf{Z}$, denoted $\text{d-sep}_\mathcal{G}(\mathbf{X};\mathbf{Y}\vert\mathbf{Z})$, if there is no active trail between any node $X\in\mathbf{X}$ and $Y\in\mathbf{Y}$ given $\mathbf{Z}$.</p><p>We define the <strong>global Markov independencies</strong> associated with $\mathcal{G}$, denoted $\mathcal{I}(\mathcal{G})$, to be the set of all independencies that correspond to d-separation in $\mathcal{G}$
\begin{equation}
\mathcal{I}(\mathcal{G})=\big\{(\mathbf{X}\perp\mathbf{Y}\vert\mathbf{Z}):\text{d-sep}_\mathcal{G}(\mathbf{X};\mathbf{Y}\vert\mathbf{Z})\big\}
\end{equation}</p><h4 id=soundness-completeness-bn>Soundness, Completeness<a hidden class=anchor aria-hidden=true href=#soundness-completeness-bn>#</a></h4><p><strong>Theorem 2</strong> (Soundness of d-separation) <em>If a distribution $P$ factorizes according to $\mathcal{G}$, then</em>
\begin{equation}
\mathcal{I}(\mathcal{G})\subset\mathcal{I}(P)
\end{equation}
The soundness property says that if $\text{d-sep}_\mathcal{G}(X;Y\vert\mathbf{Z})$ then they are conditional independent given $\mathbf{Z}$, or $(X\perp Y\vert\mathbf{Z})$.</p><p><strong>Theorem 3</strong> (Completeness of d-separation) <em>If two variables $X$ and $Y$ are independent given $\mathbf{Z}$, then they are d-separated.</em></p><p>The completeness property says that d-separation detects all possible independencies.</p><p><strong>Theorem 4</strong>: <em>Let $\mathcal{G}$ be a BN graph. If $X$ and $Y$ are not d-separated given $\mathbf{Z}$, then $X$ and $Y$ are dependent given $\mathbf{Z}$ in some distribution $P$ that factorizes over $\mathcal{G}$</em>.</p><p><strong>Theorem 5</strong>: <em>For almost all distributions $P$ that factorize over $\mathcal{G}$, i.e. for all distributions except for a set of measure zero in the space of CPD parameterizations, we have that</em>
\begin{equation}
\mathcal{I}(\mathcal{G})=\mathcal{I}(P)
\end{equation}
These results state that for almost all parameterizations $P$ of the graph $\mathcal{G}$, the d-separation test precisely characterizes the independencies that hold for $P$.</p><h4 id=i-equivalence>I-Equivalence<a hidden class=anchor aria-hidden=true href=#i-equivalence>#</a></h4><p>Two graph $\mathcal{K}_1$ and $\mathcal{K}_2$ over $\mathcal{X}$ are said to be <strong>I-equivalent</strong> if they encode the same set of conditional independencies assertions, i.e.
\begin{equation}
\mathcal{I}(\mathcal{K}_1)=\mathcal{I}(\mathcal{K}_2)
\end{equation}
This implies that any distribution $P$ that factorizes over $\mathcal{K}_1$ also factorizes according to $\mathcal{K}_2$ and vice versa.</p><p>The <strong>skeleton</strong> of a BN graph $\mathcal{G}$ over $\mathcal{X}$ is an undirected graph over $\mathcal{X}$ containing an edge $\{X,Y\}$ for every edge $(X,Y)$ in $\mathcal{G}$.</p><p><strong>Theorem 6</strong> (skeleton + v-structures $\Rightarrow$ I-equivalence) <em>Let $\mathcal{G}_1$ and $\mathcal{G_2}$ be two graphs over $\mathcal{X}$. If $\mathcal{G}_1,\mathcal{G}_2$ both have the same skeleton and the same set of v-structures then they are I-equivalent</em>.<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><figure><img src=/images/pgm-representation/I-equivalence.png alt="I-equivalent graphs" style=display:block;margin-left:auto;margin-right:auto;width:80%;height:80%><figcaption style=text-align:center;font-style:italic><b>Figure 3</b>: (taken from the <a href=#pgm-book>PGM book</a>) Two graphs have the same skeleton and set of v-structures, i.e. $\{X\rightarrow Y\leftarrow Z\}$, and thus are I-equivalent</figcaption></figure><h5 id=immorality>Immorality<a hidden class=anchor aria-hidden=true href=#immorality>#</a></h5><p>A v-structure $X\rightarrow Z\leftarrow Y$ is an <strong>immorality</strong> if there is no direct edge between. If there is such an edge, it is called a <strong>covering edge</strong> for the v-structure.</p><p>It is easily seen that not every v-structure is an immorality, which implies that two networks with the same set of immoralities do not necessarily have the same set of v-structures.</p><p><strong>Theorem 7</strong> (skeleton + immoralities $\Leftrightarrow$ I-equivalence) <em>Let $\mathcal{G}_1$ and $\mathcal{G_2}$ be two graphs over $\mathcal{X}$. If $\mathcal{G}_1,\mathcal{G}_2$ both have the same skeleton and the same set of immoralities iff they are I-equivalent</em>.</p><p><strong>Proof</strong></p><ul id=number-list><li>To prove the theorem, we first introduce the notion of <b>minimal active trail</b> and <b>triangle</b>.<br><b>Definition</b> (Minimal active trail) An active trail $X_1,\ldots,X_m$ is <b>minimal</b> if there is no other active trail from $X_1$ to $X_m$ that shortcuts some of the nodes, i.e. there is no active trail
\begin{equation}
X_1\rightleftharpoons X_{i_1}\rightleftharpoons\ldots X_{i_k}\rightleftharpoons X_m\hspace{1cm}\text{for }1\lt i_1\lt\ldots\lt i_k\lt m
\end{equation}
<b>Definition</b> (Triangle) Any three consecutive nodes in a trail $X_1,\ldots,X_m$ are called a <b>triangle</b> if their skeleton is fully connected, i.e. forms a 3-clique.<br><br>Our attention now is to prove that the only possible triangle in minimal active trail is the one having form of $X_{i-1}\leftarrow X_i\rightarrow X_{i+1}$ and either $X_{i-1}\rightarrow X_{i+1}$ or $X_{i-1}\leftarrow X_{i+1}$.<br>Consider a two-edge trail from $X_{i-1}$ to $X_{i+1}$ via $X_i$, which as being <a href=#two-edge-trail>mentioned</a> above, has four possible forms<ul id=alpha-list><li>$X_{i-1}\rightarrow X_i\rightarrow X_{i+1}$<br>It is easily seen that $X_i$ has to be not observed to make the trail active. If $X_{i-1}$ is connected to $X_{i+1}$ via $X_{i-1}\rightarrow X_{i+1}$, this gives rise to a shortcut. On the other hand, if they are connected by $X_{i-1}\leftarrow X_{i+1}$, the triangle now induces a cycle.</li><li>$X_{i-1}\leftarrow X_i\leftarrow X_{i+1}$<br>This case is symmetrically identical to the previous one, and thus is not viable.</li><li>$X_{i-1}\leftarrow X_i\rightarrow X_{i+1}$<br>The first observation is that $X_i$ has to be not given. The second observation is $X_{i-1}$ and $X_{i+1}$ are symmetric through $X_i$, so we only need to consider some specific cases of $X_{i-1}$ and the same logic is applied to $X_{i+1}$ analogously.<br>Let us examine the two-edge trail $X_{i-2},X_{i-1},X_i$. On the one hand, if we have $X_{i-2}\rightarrow X_{i-1}$, $X_{i-1}$ then has to be given, which implies that<ul><li>If $X_{i-1}\leftarrow X_{i+1}$ exists, it will create a shortcut, which is not allowed.</li><li>If $X_{i-1}\rightarrow X_{i+1}$ exists, no shortcut appears, $X_{i-1},X_i,X_{i+1}$ satisfies the condition of a triangle in the minimal active trail $X_1,\ldots,X_m$.</li></ul>On the other hand, if we have $X_{i-2}\leftarrow X_{i-1}$, then $X_{i-1}$ is not observed, analogously, we instead have<ul><li>If $X_{i-1}\leftarrow X_{i+1}$ exists, no shortcut is formed, $X_{i-1},X_i,X_{i+1}$ create a triangle.</li><li>If $X_{i-1}\rightarrow X_{i+1}$ exists, $X_{i-1},X_i,X_{i+1}$ is do not form a triangle due to the appearance of a shortcut through $X_{i-1}$ to $X_{i+1}$.</li></ul></li><li>$X_{i-1}\rightarrow X_i\leftarrow X_{i+1}$<br>In this case, $X_i$ or one of its descendant is observed. Using the similar procedure to previous case gives us no viable triangle formed by $X_{i-1},X_i,X_{i+1}$.</li></ul>Given these results, we are now ready for the main part. Let us begin with the forward path.</li><li>Skeleton + Immoralities $\Rightarrow$ I-equivalence<br>Assume that there exists node $X,Y,Z$ such that
\begin{align}
(X\perp Y\vert Z)&\in\mathcal{I}(\mathcal{G}_1), \\ (X\perp Y\vert Z)&\not\in\mathcal{I}(\mathcal{G}_2),
\end{align}
which implies that there is an active trail through $X,Y$ and $Z$ in the graph $\mathcal{G}_2$. Let us consider the minimal one and continue by examining two cases that whether $Z$ is observed.<ul id=alpha-list><li>If $Z$ is observed, in $\mathcal{G}_1$, we have $X\rightarrow Z\rightarrow Y$, or $X\leftarrow Z\leftarrow Y$, or $X\leftarrow Z\rightarrow Y$, while we have $X\rightarrow Z\leftarrow Y$ in $\mathcal{G}_2$, which is a v-structure. To assure that both graphs have the same set of moralities, there exist an edge that directly connects $X$ and $Y$, or in other words, $X,Y,Z$ form a triangle. This contradicts to the claim we have proved in the previous part.</li><li>If $Z$ is not observed, thus in $\mathcal{G}_1$, $X,Y,Z$ now must form a v-structure $X\rightarrow Z\leftarrow Y$. And also, to guarantee that both graphs have the same moralities, there exists an edge, without loss of generality, we assume $X\rightarrow Y$. However, this edge will active the trail $X,Y,Z$, or in other words, in $\mathcal{G}_1$, we now have $(X\not\perp Y\vert Z)$, which is a contradiction of our assumption.</li></ul></li><li>Skeleton + Immoralities $\Leftarrow$ I-equivalence<br>Consider two I-equivalent graphs $\mathcal{G}_1$ and $\mathcal{G}_2$.<ul id=alpha-list><li>First assuming that they do not have that same skeleton. This implies without loss of generality that there exists a trail in $\mathcal{G}_1$ that does not appear in $\mathcal{G}_2$, which induces a conditional independence in $\mathcal{G}_1$ but not in $\mathcal{G}_2$, contradicts to the fact that they two graphs are I-equivalent.</li><li>Now assuming that two graphs do not have the same set of moralities.</li></ul></li></ul><h2 id=ugm>Undirected Graphical Model<a hidden class=anchor aria-hidden=true href=#ugm>#</a></h2><p>Similar to the directed case, each node in an undirected graphical model represents a random variable. However, as indicated from the name, each edge that connects two nodes is now undirected, and thus can not describe causal relationship between those nodes as in Bayesian network.</p><h3 id=mrf>Markov Random Fields<a hidden class=anchor aria-hidden=true href=#mrf>#</a></h3><p>An <strong>Undirected Graphical Model</strong> (or <strong>Markov Random Field</strong>, or <strong>Markov network</strong>) represents a probability distribution $P$ over variables $X_1,\ldots,X_n$ defined by an undirected graph $\mathcal{H}$ in which each node correspond to a variable $X_i$, and a set of positive <strong>potential functions</strong> $\psi_c$ associated with the <a href=#clique>cliques</a> of $\mathcal{H}$ such that
\begin{equation}
P(X_1,\ldots,X_n)=\frac{1}{Z}\prod_{c\in C}\psi_c(X_c),\label{eq:mrf.1}
\end{equation}
where</p><ul><li>$P$ is also called a <strong>Gibbs distribution</strong></li><li>$C$ denotes the set of cliques of $\mathcal{H}$</li><li>$X_c$ represents the set of nodes within clique $c$</li><li>$Z$ is known as the <strong>partition function</strong>, given by
\begin{equation}
Z=\sum_{X_1,\ldots,X_n}\prod_{c\in C}\psi_c(X_c)
\end{equation}</li></ul><p>From the above definition, we say that a distribution $P$ is a Gibbs distribution that factorizes over $\mathcal{H}$ if it can be expressed as a normalized product over all potential functions defined on the cliques of $\mathcal{H}$, as in \eqref{eq:mrf.1}.</p><h3 id=independencies-in-markov-network>Independencies in Markov Network<a hidden class=anchor aria-hidden=true href=#independencies-in-markov-network>#</a></h3><p>Analogy to Bayesian network, the graph structure in a Markov Random Field can be viewed as encoding a set of independence assumptions, which can be specified by considering the undirected paths through nodes.</p><h4 id=separation>Separation<a hidden class=anchor aria-hidden=true href=#separation>#</a></h4><p>Let $\mathcal{H}$ be a Markov network structure and let $X_1-\ldots-X_k$ be a <a href=#path>path</a> in $\mathcal{H}=(\mathcal{X},\mathcal{E})$. Let $\mathbf{Z}\subset\mathcal{X}$ be a set of observed variables. Then $X_1-\ldots-X_k$ is <strong>active</strong> given $\mathbf{Z}$ if none of $X_1,\ldots,X_k$ is in $\mathbf{Z}$.</p><p>Let $\mathbf{X},\mathbf{Y}$ be set of nodes in $\mathcal{H}$. We say that $\mathbf{Z}$ <strong>separates</strong> $\mathbf{X}$ and $\mathbf{Y}$, denoted $\text{sep}_\mathcal{H}(\mathbf{X};\mathbf{Y}\vert\mathbf{Z})$ if there is no active path between any node $X\in\mathbf{X}$ and $Y\in\mathbf{Y}$ given $\mathbf{Z}$.</p><h4 id=global-markov-independencies>Global Markov Independencies<a hidden class=anchor aria-hidden=true href=#global-markov-independencies>#</a></h4><p>As in the case of Bayesian network, we define the <strong>global Markov independencies</strong> associated with $\mathcal{H}$, denoted $\mathcal{I}(\mathcal{H})$, to be the set of all independencies correspond to separation in $\mathcal{H}$
\begin{equation}
\mathcal{I}(\mathcal{H})=\big\{(\mathbf{X}\perp\mathbf{Y}\vert\mathbf{Z}):\text{sep}_\mathcal{H}(\mathbf{X};\mathbf{Y}\vert\mathbf{Z})\big\}
\end{equation}</p><h4 id=local-markov-independencies>Local Markov Independencies<a hidden class=anchor aria-hidden=true href=#local-markov-independencies>#</a></h4><p>Let $\mathcal{H}$ be a Markov network. We define the <strong>pairwise independencies</strong> associated with $\mathcal{H}$ to be
\begin{equation}
\mathcal{I}_p(\mathcal{H})=\big\{(X\perp Y\vert\mathcal{X}\backslash\{X,Y\}):X-Y\notin\mathcal{H}\big\}
\end{equation}
Or in other words, the pairwise independencies states that $X$ and $Y$ are independent given all other nodes in $\mathcal{H}$.</p><p>For a given graph $\mathcal{H}$ and for an arbitrary node $X$ of $\mathcal{H}$, the set of <a href=#neighbor>neighbors</a> of $X$ is also called the <strong>Markov blanket</strong> of $X$, denoted $\text{MB}_\mathcal{H}(X)$. With this notion, we define the <strong>local independencies</strong>, or <strong>Markov local independencies</strong>, associated with $\mathcal{H}$ to be
\begin{equation}
\mathcal{I}_\ell(\mathcal{H})=\big\{\big(X\perp\mathcal{X}\backslash(\{X\}\cup\text{MB}_\mathcal{H}(X))\vert\text{MB}_\mathcal{H}(X)\big):X\in\mathcal{X}\big\}
\end{equation}
Or in other words, the Markov local independencies says that $X$ is independent of the rest of the nodes in $\mathcal{H}$ given its neighbors.</p><h4 id=markov-independencies-relationships>Markov Independencies Relationships<a hidden class=anchor aria-hidden=true href=#markov-independencies-relationships>#</a></h4><p><strong>Theorem 8</strong>: <em>Let $\mathcal{H}$ be a Markov network and $P$ be a positive distribution. The following three statement are then equivalent:</em></p><ul id=roman-list style=font-style:italic><li>$P\models\mathcal{I}_\ell(\mathcal{H})$.</li><li>$P\models\mathcal{I}_p(\mathcal{H})$.</li><li>$P\models\mathcal{I}(\mathcal{H})$.</li></ul><p><strong>Proof</strong></p><ul id=number-list><li>(i) $\Rightarrow$ (ii)<br>Consider an arbitrary node $X$ in $\mathcal{H}$. Let $Y\in\mathcal{X}$ such that $X-Y\notin\mathcal{H}$, then $Y\notin\text{MB}_\mathcal{H}(X)$, or in other words
\begin{equation}
Y\in\mathcal{X}\backslash(\{X\}\cup\text{MB}_\mathcal{H}(X))
\end{equation}
Moreover, since $P\models\mathcal{I}_\ell(\mathcal{H})$, we have that $P$ satisfies
\begin{equation}
\big(X\perp\mathcal{X}\backslash(\{X\}\cup\text{MB}_\mathcal{H}(X))\vert\text{MB}_\mathcal{H}(X)\big),
\end{equation}
which implies that
\begin{equation}
\big(X\perp Y\vert\text{MB}_\mathcal{X}\cup\mathcal{X}\backslash(\{X,Y\}\cup\text{MB}_\mathcal{H}(X))\big)
\end{equation}
holds for $P$. Or in other words, for any $X,Y$ such that $X-Y\notin\mathcal{H}$, we have
\begin{equation}
P\models(X\perp Y\vert\mathcal{X}\backslash\{X,Y\}),
\end{equation}
which proves our claim.</li><li>(ii) $\Rightarrow$ (iii)<br>Consider arbitrary non-empty subsets $\mathbf{X},\mathbf{Y},\mathbf{Z}$ of $\mathcal{X}$. We need to show that
\begin{equation}
\text{sep}_\mathcal{H}(\mathbf{X};\mathbf{Y}\vert\mathbf{Z})\Rightarrow P\models(\mathbf{X}\perp\mathbf{Y}\vert\mathbf{Z})\label{eq:mir.1}
\end{equation}
We will be using induction to prove the claim. Specifically, first consider the case that $\vert\mathbf{Z}\vert=\vert\mathcal{X}\vert-2=n-2$, which implies that $\vert\mathbf{X}\vert=\vert\mathbf{Y}\vert=1$. Hence, \eqref{eq:mir.1} follows directly from definition of $\mathcal{I}_p(\mathcal{H})$.</li><li>(iii) $\Rightarrow$ (i)<br>Consider arbitrary disjoint subsets $\mathbf{X},\mathbf{Y},\mathbf{Z}$ of $\mathcal{X}$ such that
\begin{equation}
\text{sep}_\mathcal{H}(\mathbf{X};\mathbf{Y}\vert\mathbf{Z})
\end{equation}
We will be examining two cases. First, consider the case that $\mathbf{X}\cup\mathbf{Y}\cup\mathbf{Z}=\mathcal{X}$.</li></ul><h4 id=soundness-completeness>Soundness, Completeness<a hidden class=anchor aria-hidden=true href=#soundness-completeness>#</a></h4><p><strong>Theorem 9</strong> (Soundness of separation) <em>Let $\mathcal{H}=(\mathcal{X},\mathcal{E})$ be a Markov network structure and let $P$ be a distribution over $\mathcal{X}$. If $P$ is a Gibbs distribution that factorizes over $\mathcal{H}$, then $\mathcal{H}$ is an I-map for $P$.</em></p><p><strong>Proof</strong><br>Let $\mathbf{X},\mathbf{Y}$ and $\mathbf{Z}$ be any disjoint subsets of $\mathcal{X}$ such that $\text{sep}_\mathcal{H}(\mathbf{X};\mathbf{Y}\vert\mathbf{Z})$. We need to show that
\begin{equation}
P\models(\mathbf{X}\perp\mathbf{Y}\vert\mathbf{Z})
\end{equation}
We begin by considering the case that $\mathbf{X}\cup\mathbf{Y}\cup\mathbf{Z}=\mathcal{X}$. Since $\mathbf{Z}$ separates $\mathbf{X}$ and $\mathbf{Y}$, then for any $X\in\mathbf{X}$ and for any $Y\in\mathbf{Y}$, there is no direct edge between $X,Y$. This implies that any clique in $\mathcal{H}$ is either in $\mathbf{X}\cup\mathbf{Z}$ or in $\mathbf{Y}\cup\mathbf{Z}$.</p><p>Let $C_\mathbf{X}$ denote the set of cliques within $\mathbf{X}\cup\mathbf{Z}$ and let $C_\mathbf{Y}$ represent the set of cliques in $\mathbf{Y}\cup\mathbf{Z}$. Thus, as $P$ factorizes over $\mathcal{H}$, we have that
\begin{align}
P(X_1,\ldots,X_n)&=\frac{1}{Z}\left(\prod_{c\in C_\mathbf{X}}\psi(X_c)\right)\left(\prod_{c\in C_\mathbf{Y}}\psi(X_c)\right) \\ &=\frac{1}{Z}\psi_\mathbf{X}(\mathbf{X},\mathbf{Z})\psi_\mathbf{Y}(\mathbf{Y},\mathbf{Z}),
\end{align}
where $\psi_\mathbf{X},\psi_\mathbf{Y}$ are some factor with scopes $\mathbf{X}\cup\mathbf{Z}$ and $\mathbf{Y}\cup\mathbf{Z}$ respectively. Hence, it follows that
\begin{equation}
P\models(\mathbf{X}\perp\mathbf{Y}\vert\mathbf{Z})
\end{equation}
Now consider the case that $\mathbf{X}\cup\mathbf{Y}\cup\mathbf{Z}\subset\mathcal{X}$. Let $\mathbf{U}=\mathcal{X}\backslash(\mathbf{X}\cup\mathbf{Y}\cup\mathbf{Z})$. We can divide $\mathbf{U}$ into two disjoint sets $\mathbf{U}_1$ and $\mathbf{U}_2$ such that
\begin{equation}
\text{sep}_\mathcal{H}(\mathbf{X}\cup\mathbf{U}_1;\mathbf{Y}\cup\mathbf{U}_2\vert\mathbf{Z})
\end{equation}
And since $(\mathbf{X}\cup\mathbf{U}_1)\cup(\mathbf{Y}\cup\mathbf{U}_2)\cup\mathbf{Z}=\mathcal{X}$, we can follow the previous procedure to conclude that
\begin{equation}
P\models(\mathbf{X}\cup\mathbf{U}_1\perp\mathbf{Y}\cup\mathbf{U}_2\vert\mathbf{Z}),
\end{equation}
which implies that
\begin{equation}
P\models(\mathbf{X}\perp\mathbf{Y}\vert\mathbf{Z})
\end{equation}</p><p><strong>Theorem 10</strong> (Hammersley-Clifford) <em>Let $\mathcal{H}=(\mathcal{X},\mathcal{E})$ be a Markov network structure and let $P$ be a positive distribution over $\mathcal{X}$. If $\mathcal{H}$ is an I-map for $P$, then $P$ is a Gibbs distribution that factorizes over $\mathcal{H}$.</em></p><p><strong>Corollary 11</strong> <em>The positive distribution $P$ factorizes a Markov network $\mathcal{H}$ iff $\mathcal{H}$ is an I-map for $P$</em>.</p><p><strong>Theorem 12</strong> (Completeness of separation) <em>Let $\mathcal{H}$ be a Markov network structure. If $X$ and $Y$ are not separated given $\mathbf{Z}$ in $\mathcal{H}$, then $X$ and $Y$ are dependent given $\mathbf{Z}$ in some distribution $P$ that factorizes over $\mathcal{H}$.</em></p><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><p>[1] <span id=pgm-book>Daphne Koller, Nir Friedman. <a href=https://mitpress.mit.edu/9780262013192/probabilistic-graphical-models/>Probabilistic Graphical Models</a>. The MIT Press.</span></p><p>[2]</p><p>[3] Eric P.Xing <a href>10-708: Probabilistic Graphical Model</a>. CMU Spring 2019.</p><p>[4] <a href>CS228: Probabilistic Graphical Model</a>. Stanford 2017.</p><h2 id=footnotes>Footnotes<a hidden class=anchor aria-hidden=true href=#footnotes>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Note that $X_i\rightarrow X_j\equiv X_j\leftarrow X_i$ but $X_i\rightarrow X_j\not\equiv X_i\leftarrow X_j$, while $X_i-X_j\equiv X_j-X_i$.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Note that the inverse is not true.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://trunghng.github.io/tags/machine-learning/>machine-learning</a></li></ul><nav class=paginav><a class=prev href=https://trunghng.github.io/posts/reinforcement-learning/maxent-sql-sac/><span class=title>« Prev</span><br><span>Maximum Entropy Reinforcement Learning via Soft Q-learning & Soft Actor-Critic</span></a>
<a class=next href=https://trunghng.github.io/posts/reinforcement-learning/deterministic-policy-gradients/><span class=title>Next »</span><br><span>Deterministic Policy Gradients</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Probabilistic Graphical Model - Representation on twitter" href="https://twitter.com/intent/tweet/?text=Probabilistic%20Graphical%20Model%20-%20Representation&url=https%3a%2f%2ftrunghng.github.io%2fposts%2fmachine-learning%2fpgm-representation%2f&hashtags=machine-learning"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Probabilistic Graphical Model - Representation on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ftrunghng.github.io%2fposts%2fmachine-learning%2fpgm-representation%2f&title=Probabilistic%20Graphical%20Model%20-%20Representation&summary=Probabilistic%20Graphical%20Model%20-%20Representation&source=https%3a%2f%2ftrunghng.github.io%2fposts%2fmachine-learning%2fpgm-representation%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Probabilistic Graphical Model - Representation on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ftrunghng.github.io%2fposts%2fmachine-learning%2fpgm-representation%2f&title=Probabilistic%20Graphical%20Model%20-%20Representation"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Probabilistic Graphical Model - Representation on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ftrunghng.github.io%2fposts%2fmachine-learning%2fpgm-representation%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Probabilistic Graphical Model - Representation on whatsapp" href="https://api.whatsapp.com/send?text=Probabilistic%20Graphical%20Model%20-%20Representation%20-%20https%3a%2f%2ftrunghng.github.io%2fposts%2fmachine-learning%2fpgm-representation%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Probabilistic Graphical Model - Representation on telegram" href="https://telegram.me/share/url?text=Probabilistic%20Graphical%20Model%20-%20Representation&url=https%3a%2f%2ftrunghng.github.io%2fposts%2fmachine-learning%2fpgm-representation%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer><script src=https://utteranc.es/client.js repo=trunghng/trunghng.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2023 <a href=https://trunghng.github.io>Trung's Place</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>