---
layout: post
title:  "CMA Evolution Strategy"
date:   2022-09-14 13:00:00 +0700
categories: artificial-intelligent machine-learning
tags: artificial-intelligent evolution-strategy
description: A note CMA-ES
comments: true
eqn-number: true
---
> A note on CMA - Evolution Strategy
<!-- excerpt-end -->

- [Basic equation](#bsc-eqn)
- [Updating the mean](#update-mean)
- [References](#references)
- [Footnotes](#footnotes)

## Basic equation
{: #bsc-eqn}
In the CMA-ES, a population of new search points (individual, offspring) is generated by sampling a MVN, in which for generation number $g$, for $g=0,1,2,\ldots$
\begin{align}
\mathbf{x}\_k^{(g+1)}&\sim\mathbf{m}^{(g)}+\sigma^{(g)}\mathcal{N}(\mathbf{0},\mathbf{C}^{(g)}),\hspace{1cm}k=1,\ldots,\lambda \\\\ &=\mathcal{N}\left(\mathbf{m}^{(g)},(\sigma^{(g)})^2\mathbf{C}^{(g)}\right)\label{eq:be.1}
\end{align}
where
- $\mathbf{x}\_k^{(g+1)}\in\mathbb{R}^n$: $k$-th offspring from generation $g+1$
- $\mathbf{m}^{(g)}\in\mathbb{R}^n$: mean value of the search distribution at generation $g$
- $\sigma^{(g)}\in\mathbb{R}^n$: "overall" standard deviation, step-size at generation $g$.
- $\mathbf{C}^{(g)}$: covariance matrix at generation $g$; $(\sigma^{(g)})^2\mathcal{C}^{(g)}$ is the covariance matrix of the search distribution.
- $\lambda\geq 2$: population size, sample size, number of offspring. 

## Updating the mean
{: #update-mean}
The mean $\mathbf{m}^{(g+1)}$ of the search distribution is defined as the weighted average of $\mu$ selected points from the sample $\mathbf{x}\_1^{(g+1)},\ldots,\mathbf{x}\_\lambda^{(g+1)}$:
\begin{equation}
\mathbf{m}^{(g+1)}=\sum_{i=1}^{\mu}w_i\mathbf{x}\_{i:\lambda}^{(g+1)},
\end{equation}
where
- $\sum_{i=1}^{\mu}w_i=1$ with $w_1\geq w_2\geq\ldots\geq w_\mu>0$: coefficients for recombination.
- $\mu\leq\lambda$: parent population size.
- $\mathbf{x}\_{i:\lambda}^{(g+1)}$: $i$-th best offspring out of $\mathbf{x}\_1^{(g+1)},\ldots,\mathbf{x}\_\lambda^{(g+1)}$ from \eqref{eq:be.1}, i.e., with $f$ is the objective function to be minimized, we have
\begin{equation}
f(\mathbf{x}\_{1:\lambda}^{(g+1)})\geq f(\mathbf{x}\_{2:\lambda}^{(g+1)})\geq\ldots\geq f(\mathbf{x}\_{\lambda:\lambda}^{(g+1)})
\end{equation}

## References
{: #references}
[1] Nikolaus Hansen. [The CMA Evolution Strategy: A Tutorial](#https://arxiv.org/abs/1604.00772). 

## Footnotes
{: #footnotes}
